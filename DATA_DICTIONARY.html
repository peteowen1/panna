<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Panna Data Dictionary • panna</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Panna Data Dictionary"><meta property="og:image" content="https://peteowen1.github.io/panna/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">panna</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="articles/pipeline-walkthrough.html">Pipeline Walkthrough</a></li>
    <li><a class="dropdown-item" href="articles/player-ratings.html">Player Ratings Methodology</a></li>
    <li><a class="dropdown-item" href="articles/data-sources.html">Data Sources Guide</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/peteowen1/panna/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>Panna Data Dictionary</h1>
      <small class="dont-index">Source: <a href="https://github.com/peteowen1/panna/blob/main/DATA_DICTIONARY.md" class="external-link"><code>DATA_DICTIONARY.md</code></a></small>
    </div>

<div id="panna-data-dictionary" class="section level1">

<p>This document describes all data structures used in the panna pipeline.</p>
<div class="section level2">
<h2 id="pipeline-overview">Pipeline Overview<a class="anchor" aria-label="anchor" href="#pipeline-overview"></a></h2>
<pre><code>01_data_collection.R  -&gt;  01_raw_data.rds
02_data_processing.R  -&gt;  02_processed_data.rds
03_splint_creation.R  -&gt;  03_splints.rds
04_rapm.R             -&gt;  04_rapm.rds
05_spm.R              -&gt;  05_spm.rds
06_xrapm.R            -&gt;  06_xrapm.rds
07_panna_ratings.R    -&gt;  07_panna.rds</code></pre>
<hr></div>
<div class="section level2">
<h2 id="id_01_raw_datards">01_raw_data.rds<a class="anchor" aria-label="anchor" href="#id_01_raw_datards"></a></h2>
<p>Raw data from pannadata repository. All columns are snake_case after <code><a href="reference/clean_column_names.html">clean_column_names()</a></code>.</p>
<div class="section level3">
<h3 id="results">results<a class="anchor" aria-label="anchor" href="#results"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_url</td>
<td>character</td>
<td>FBref match URL (unique identifier)</td>
</tr><tr class="even"><td>home</td>
<td>character</td>
<td>Home team name</td>
</tr><tr class="odd"><td>away</td>
<td>character</td>
<td>Away team name</td>
</tr><tr class="even"><td>home_goals</td>
<td>numeric</td>
<td>Home team goals</td>
</tr><tr class="odd"><td>away_goals</td>
<td>numeric</td>
<td>Away team goals</td>
</tr><tr class="even"><td>home_x_g</td>
<td>numeric</td>
<td>Home team xG</td>
</tr><tr class="odd"><td>away_x_g</td>
<td>numeric</td>
<td>Away team xG</td>
</tr><tr class="even"><td>date</td>
<td>Date</td>
<td>Match date</td>
</tr><tr class="odd"><td>season_end_year</td>
<td>numeric</td>
<td>Season end year (e.g., 2024 for 2023-24)</td>
</tr><tr class="even"><td>league</td>
<td>character</td>
<td>League name (multi-league only)</td>
</tr><tr class="odd"><td>country</td>
<td>character</td>
<td>Country code (multi-league only)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="lineups-derived-from-stats_passing">lineups (derived from stats_passing)<a class="anchor" aria-label="anchor" href="#lineups-derived-from-stats_passing"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_url</td>
<td>character</td>
<td>FBref match URL</td>
</tr><tr class="even"><td>team</td>
<td>character</td>
<td>Team name</td>
</tr><tr class="odd"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="even"><td>player_href</td>
<td>character</td>
<td>FBref player ID</td>
</tr><tr class="odd"><td>pos</td>
<td>character</td>
<td>Position (e.g., “FW”, “MF”)</td>
</tr><tr class="even"><td>min</td>
<td>numeric</td>
<td>Minutes played</td>
</tr><tr class="odd"><td>home_away</td>
<td>character</td>
<td>“Home” or “Away”</td>
</tr><tr class="even"><td>is_starter</td>
<td>logical</td>
<td>TRUE if minutes &gt;= 45</td>
</tr><tr class="odd"><td>minutes</td>
<td>numeric</td>
<td>Minutes played</td>
</tr><tr class="even"><td>is_home</td>
<td>logical</td>
<td>TRUE if home team</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="events-from-match-summary">events (from match summary)<a class="anchor" aria-label="anchor" href="#events-from-match-summary"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_url</td>
<td>character</td>
<td>FBref match URL</td>
</tr><tr class="even"><td>team</td>
<td>character</td>
<td>Team involved</td>
</tr><tr class="odd"><td>event_type</td>
<td>character</td>
<td>Event type from FBref</td>
</tr><tr class="even"><td>minute</td>
<td>numeric</td>
<td>Minute of event</td>
</tr><tr class="odd"><td>player</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="even"><td>is_goal</td>
<td>logical</td>
<td>Goal event</td>
</tr><tr class="odd"><td>is_sub</td>
<td>logical</td>
<td>Substitution event</td>
</tr><tr class="even"><td>is_penalty</td>
<td>logical</td>
<td>Penalty goal</td>
</tr><tr class="odd"><td>is_own_goal</td>
<td>logical</td>
<td>Own goal</td>
</tr><tr class="even"><td>is_red_card</td>
<td>logical</td>
<td>Red card event</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="shooting">shooting<a class="anchor" aria-label="anchor" href="#shooting"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_url</td>
<td>character</td>
<td>FBref match URL</td>
</tr><tr class="even"><td>squad</td>
<td>character</td>
<td>Shooting team</td>
</tr><tr class="odd"><td>player</td>
<td>character</td>
<td>Shooter name</td>
</tr><tr class="even"><td>minute</td>
<td>numeric</td>
<td>Shot minute</td>
</tr><tr class="odd"><td>x_g</td>
<td>numeric</td>
<td>Shot xG</td>
</tr><tr class="even"><td>outcome</td>
<td>character</td>
<td>“Goal” or other</td>
</tr><tr class="odd"><td>body_part</td>
<td>character</td>
<td>Body part used</td>
</tr><tr class="even"><td>notes</td>
<td>character</td>
<td>Shot details</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="stats_summary-stats_passing-stats_defense-stats_possession">stats_summary, stats_passing, stats_defense, stats_possession<a class="anchor" aria-label="anchor" href="#stats_summary-stats_passing-stats_defense-stats_possession"></a></h3>
<p>Advanced player stats per match. See <code>pannadata/DATA_DICTIONARY.md</code> for full column definitions.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_02_processed_datards">02_processed_data.rds<a class="anchor" aria-label="anchor" href="#id_02_processed_datards"></a></h2>
<p>Cleaned and standardized data.</p>
<div class="section level3">
<h3 id="results-1">results<a class="anchor" aria-label="anchor" href="#results-1"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Unique match ID (season_date_home_away hash)</td>
</tr><tr class="even"><td>season</td>
<td>numeric</td>
<td>Season end year</td>
</tr><tr class="odd"><td>date</td>
<td>Date</td>
<td>Match date</td>
</tr><tr class="even"><td>match_url</td>
<td>character</td>
<td>FBref URL</td>
</tr><tr class="odd"><td>home_team</td>
<td>character</td>
<td>Standardized home team name</td>
</tr><tr class="even"><td>away_team</td>
<td>character</td>
<td>Standardized away team name</td>
</tr><tr class="odd"><td>home_goals</td>
<td>numeric</td>
<td>Home goals</td>
</tr><tr class="even"><td>away_goals</td>
<td>numeric</td>
<td>Away goals</td>
</tr><tr class="odd"><td>goal_diff</td>
<td>numeric</td>
<td>home_goals - away_goals</td>
</tr><tr class="even"><td>home_xg</td>
<td>numeric</td>
<td>Home xG</td>
</tr><tr class="odd"><td>away_xg</td>
<td>numeric</td>
<td>Away xG</td>
</tr><tr class="even"><td>xg_diff</td>
<td>numeric</td>
<td>home_xg - away_xg</td>
</tr><tr class="odd"><td>league</td>
<td>character</td>
<td>League name (if multi-league)</td>
</tr><tr class="even"><td>country</td>
<td>character</td>
<td>Country code (if multi-league)</td>
</tr><tr class="odd"><td>season_end_year</td>
<td>numeric</td>
<td>Season end year (if multi-league)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="lineups">lineups<a class="anchor" aria-label="anchor" href="#lineups"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Match ID</td>
</tr><tr class="even"><td>team</td>
<td>character</td>
<td>Team name</td>
</tr><tr class="odd"><td>is_home</td>
<td>logical</td>
<td>Home team indicator</td>
</tr><tr class="even"><td>player_name</td>
<td>character</td>
<td>Standardized player name</td>
</tr><tr class="odd"><td>player_id</td>
<td>character</td>
<td>FBref player ID (from player_href)</td>
</tr><tr class="even"><td>is_starter</td>
<td>logical</td>
<td>Started the match</td>
</tr><tr class="odd"><td>position</td>
<td>character</td>
<td>Position</td>
</tr><tr class="even"><td>minutes</td>
<td>numeric</td>
<td>Minutes played</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="events">events<a class="anchor" aria-label="anchor" href="#events"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Match ID</td>
</tr><tr class="even"><td>team</td>
<td>character</td>
<td>Team name</td>
</tr><tr class="odd"><td>is_home</td>
<td>logical</td>
<td>Home team indicator</td>
</tr><tr class="even"><td>event_type</td>
<td>character</td>
<td>“goal”, “substitution”, or “red_card”</td>
</tr><tr class="odd"><td>minute</td>
<td>numeric</td>
<td>Event minute</td>
</tr><tr class="even"><td>player_name</td>
<td>character</td>
<td>Player involved</td>
</tr><tr class="odd"><td>is_penalty</td>
<td>logical</td>
<td>Penalty goal</td>
</tr><tr class="even"><td>is_own_goal</td>
<td>logical</td>
<td>Own goal</td>
</tr><tr class="odd"><td>is_red_card</td>
<td>logical</td>
<td>Red card</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="shooting-1">shooting<a class="anchor" aria-label="anchor" href="#shooting-1"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Match ID</td>
</tr><tr class="even"><td>team</td>
<td>character</td>
<td>Team name</td>
</tr><tr class="odd"><td>player_name</td>
<td>character</td>
<td>Shooter name</td>
</tr><tr class="even"><td>minute</td>
<td>numeric</td>
<td>Shot minute</td>
</tr><tr class="odd"><td>xg</td>
<td>numeric</td>
<td>Shot xG</td>
</tr><tr class="even"><td>is_goal</td>
<td>logical</td>
<td>Goal scored</td>
</tr><tr class="odd"><td>is_penalty</td>
<td>logical</td>
<td>Penalty shot</td>
</tr><tr class="even"><td>body_part</td>
<td>character</td>
<td>Body part</td>
</tr><tr class="odd"><td>shot_type</td>
<td>character</td>
<td>Shot details</td>
</tr></tbody></table><hr></div>
</div>
<div class="section level2">
<h2 id="id_03_splintsrds">03_splints.rds<a class="anchor" aria-label="anchor" href="#id_03_splintsrds"></a></h2>
<p>Time segments for RAPM analysis.</p>
<div class="section level3">
<h3 id="splints">splints<a class="anchor" aria-label="anchor" href="#splints"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Match ID</td>
</tr><tr class="even"><td>splint_id</td>
<td>character</td>
<td>Unique splint ID (match_id_splint_num)</td>
</tr><tr class="odd"><td>splint_num</td>
<td>integer</td>
<td>Splint number within match</td>
</tr><tr class="even"><td>start_minute</td>
<td>numeric</td>
<td>Start of splint</td>
</tr><tr class="odd"><td>end_minute</td>
<td>numeric</td>
<td>End of splint</td>
</tr><tr class="even"><td>duration</td>
<td>numeric</td>
<td>Splint duration in minutes</td>
</tr><tr class="odd"><td>avg_min</td>
<td>numeric</td>
<td>(start + end) / 2</td>
</tr><tr class="even"><td>gf_home</td>
<td>integer</td>
<td>Cumulative home goals at splint start</td>
</tr><tr class="odd"><td>ga_home</td>
<td>integer</td>
<td>Cumulative away goals at splint start</td>
</tr><tr class="even"><td>red_home</td>
<td>integer</td>
<td>Cumulative home red cards at splint start</td>
</tr><tr class="odd"><td>red_away</td>
<td>integer</td>
<td>Cumulative away red cards at splint start</td>
</tr><tr class="even"><td>n_players_home</td>
<td>integer</td>
<td>Home players on pitch (11 - red_home)</td>
</tr><tr class="odd"><td>n_players_away</td>
<td>integer</td>
<td>Away players on pitch (11 - red_away)</td>
</tr><tr class="even"><td>npxg_home</td>
<td>numeric</td>
<td>Non-penalty xG for home team in splint</td>
</tr><tr class="odd"><td>npxg_away</td>
<td>numeric</td>
<td>Non-penalty xG for away team in splint</td>
</tr><tr class="even"><td>npxgd</td>
<td>numeric</td>
<td>npxg_home - npxg_away</td>
</tr><tr class="odd"><td>npxgd_per_90</td>
<td>numeric</td>
<td>npxgd * 90 / duration</td>
</tr><tr class="even"><td>league</td>
<td>character</td>
<td>League name (if multi-league)</td>
</tr><tr class="odd"><td>season_end_year</td>
<td>numeric</td>
<td>Season (if multi-league)</td>
</tr><tr class="even"><td>country</td>
<td>character</td>
<td>Country (if multi-league)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="players">players<a class="anchor" aria-label="anchor" href="#players"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Match ID</td>
</tr><tr class="even"><td>splint_id</td>
<td>character</td>
<td>Splint ID</td>
</tr><tr class="odd"><td>splint_num</td>
<td>integer</td>
<td>Splint number</td>
</tr><tr class="even"><td>team</td>
<td>character</td>
<td>Team name</td>
</tr><tr class="odd"><td>is_home</td>
<td>logical</td>
<td>Home team indicator</td>
</tr><tr class="even"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="odd"><td>player_id</td>
<td>character</td>
<td>Player ID</td>
</tr><tr class="even"><td>start_minute</td>
<td>numeric</td>
<td>Splint start</td>
</tr><tr class="odd"><td>end_minute</td>
<td>numeric</td>
<td>Splint end</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="match_info">match_info<a class="anchor" aria-label="anchor" href="#match_info"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Match ID</td>
</tr><tr class="even"><td>season</td>
<td>numeric</td>
<td>Season end year</td>
</tr><tr class="odd"><td>home_team</td>
<td>character</td>
<td>Home team</td>
</tr><tr class="even"><td>away_team</td>
<td>character</td>
<td>Away team</td>
</tr><tr class="odd"><td>league</td>
<td>character</td>
<td>League (if multi-league)</td>
</tr><tr class="even"><td>season_end_year</td>
<td>numeric</td>
<td>Season (if multi-league)</td>
</tr></tbody></table><hr></div>
</div>
<div class="section level2">
<h2 id="id_04_rapmrds-rapm-design-matrix">04_rapm.rds (RAPM Design Matrix)<a class="anchor" aria-label="anchor" href="#id_04_rapmrds-rapm-design-matrix"></a></h2>
<div class="section level3">
<h3 id="rapm_data">rapm_data<a class="anchor" aria-label="anchor" href="#rapm_data"></a></h3>
<table class="table"><colgroup><col width="36%"><col width="20%"><col width="43%"></colgroup><thead><tr class="header"><th>Component</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>X_players</td>
<td>sparse matrix</td>
<td>Player indicators (playerX_off, playerX_def, replacement_off, replacement_def)</td>
</tr><tr class="even"><td>X_full</td>
<td>sparse matrix</td>
<td>X_players + covariates</td>
</tr><tr class="odd"><td>row_data</td>
<td>data.frame</td>
<td>See below</td>
</tr><tr class="even"><td>y</td>
<td>numeric</td>
<td>Target: xgf90</td>
</tr><tr class="odd"><td>weights</td>
<td>numeric</td>
<td>Splint duration / 90</td>
</tr><tr class="even"><td>player_mapping</td>
<td>data.frame</td>
<td>player_id, player_name, total_minutes</td>
</tr><tr class="odd"><td>player_ids</td>
<td>character</td>
<td>Player IDs (including “replacement”)</td>
</tr><tr class="even"><td>n_players</td>
<td>integer</td>
<td>Number of regular players</td>
</tr><tr class="odd"><td>covariate_names</td>
<td>character</td>
<td>Names of covariate columns</td>
</tr><tr class="even"><td>leagues</td>
<td>character</td>
<td>Unique leagues (if multi-league)</td>
</tr><tr class="odd"><td>seasons</td>
<td>numeric</td>
<td>Unique seasons (if multi-league)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="row_data-within-rapm_data">row_data (within rapm_data)<a class="anchor" aria-label="anchor" href="#row_data-within-rapm_data"></a></h3>
<table class="table"><colgroup><col width="29%"><col width="22%"><col width="48%"></colgroup><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>row_id</td>
<td>integer</td>
<td>Row number</td>
</tr><tr class="even"><td>splint_id</td>
<td>character</td>
<td>Splint ID</td>
</tr><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Match ID</td>
</tr><tr class="even"><td>xgf</td>
<td>numeric</td>
<td>xG FOR (raw)</td>
</tr><tr class="odd"><td>minutes</td>
<td>numeric</td>
<td>Splint duration</td>
</tr><tr class="even"><td>xgf90</td>
<td>numeric</td>
<td>TARGET: xG FOR per 90</td>
</tr><tr class="odd"><td>gd</td>
<td>integer</td>
<td>Goal difference (from this team’s perspective)</td>
</tr><tr class="even"><td>gf</td>
<td>integer</td>
<td>Goals for (from this team’s perspective)</td>
</tr><tr class="odd"><td>ga</td>
<td>integer</td>
<td>Goals against</td>
</tr><tr class="even"><td>avg_min</td>
<td>numeric</td>
<td>Average minute of splint</td>
</tr><tr class="odd"><td>home_away</td>
<td>character</td>
<td>“home” or “away”</td>
</tr><tr class="even"><td>n_offense</td>
<td>integer</td>
<td>Players on attacking team (accounts for red cards)</td>
</tr><tr class="odd"><td>n_defense</td>
<td>integer</td>
<td>Players on defending team</td>
</tr><tr class="even"><td>net_players</td>
<td>integer</td>
<td>n_offense - n_defense (man advantage)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="covariates-in-x_full">Covariates in X_full<a class="anchor" aria-label="anchor" href="#covariates-in-x_full"></a></h3>
<table class="table"><thead><tr class="header"><th>Covariate</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>gd</td>
<td>Goal difference at splint start</td>
</tr><tr class="even"><td>gf</td>
<td>Goals for at splint start</td>
</tr><tr class="odd"><td>ga</td>
<td>Goals against at splint start</td>
</tr><tr class="even"><td>avg_min</td>
<td>Average minute of splint</td>
</tr><tr class="odd"><td>is_home</td>
<td>1 if home team attacking, 0 otherwise</td>
</tr><tr class="even"><td>n_offense</td>
<td>Attacking team player count (11 - red cards)</td>
</tr><tr class="odd"><td>n_defense</td>
<td>Defending team player count</td>
</tr><tr class="even"><td>net_players</td>
<td>n_offense - n_defense</td>
</tr><tr class="odd"><td>league_X</td>
<td>League dummies (if multi-league)</td>
</tr><tr class="even"><td>season_X</td>
<td>Season dummies (if multi-league)</td>
</tr></tbody></table><hr></div>
</div>
<div class="section level2">
<h2 id="id_05_spmrds">05_spm.rds<a class="anchor" aria-label="anchor" href="#id_05_spmrds"></a></h2>
<p>Statistical Plus-Minus model predicting RAPM from box scores.</p>
<div class="section level3">
<h3 id="spm_ratings">spm_ratings<a class="anchor" aria-label="anchor" href="#spm_ratings"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="even"><td>spm</td>
<td>numeric</td>
<td>Overall SPM prediction</td>
</tr><tr class="odd"><td>total_minutes</td>
<td>numeric</td>
<td>Total minutes played</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="offense_spm_ratings">offense_spm_ratings<a class="anchor" aria-label="anchor" href="#offense_spm_ratings"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="even"><td>offense_spm</td>
<td>numeric</td>
<td>Offensive SPM prediction</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="defense_spm_ratings">defense_spm_ratings<a class="anchor" aria-label="anchor" href="#defense_spm_ratings"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="even"><td>defense_spm</td>
<td>numeric</td>
<td>Defensive SPM prediction</td>
</tr></tbody></table><hr></div>
</div>
<div class="section level2">
<h2 id="id_06_xrapmrds">06_xrapm.rds<a class="anchor" aria-label="anchor" href="#id_06_xrapmrds"></a></h2>
<p>RAPM with SPM prior (xRAPM).</p>
<div class="section level3">
<h3 id="ratings">ratings<a class="anchor" aria-label="anchor" href="#ratings"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>player_id</td>
<td>character</td>
<td>Player ID</td>
</tr><tr class="even"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="odd"><td>total_minutes</td>
<td>numeric</td>
<td>Total minutes</td>
</tr><tr class="even"><td>xrapm</td>
<td>numeric</td>
<td>xRAPM overall rating</td>
</tr><tr class="odd"><td>offense</td>
<td>numeric</td>
<td>Offensive xRAPM</td>
</tr><tr class="even"><td>defense</td>
<td>numeric</td>
<td>Defensive xRAPM</td>
</tr><tr class="odd"><td>off_prior</td>
<td>numeric</td>
<td>Offensive SPM prior</td>
</tr><tr class="even"><td>def_prior</td>
<td>numeric</td>
<td>Defensive SPM prior</td>
</tr><tr class="odd"><td>off_deviation</td>
<td>numeric</td>
<td>offense - off_prior</td>
</tr><tr class="even"><td>def_deviation</td>
<td>numeric</td>
<td>defense - def_prior</td>
</tr></tbody></table><hr></div>
</div>
<div class="section level2">
<h2 id="id_07_pannards">07_panna.rds<a class="anchor" aria-label="anchor" href="#id_07_pannards"></a></h2>
<p>Final unified ratings.</p>
<div class="section level3">
<h3 id="panna_ratings">panna_ratings<a class="anchor" aria-label="anchor" href="#panna_ratings"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>player_id</td>
<td>character</td>
<td>Player ID</td>
</tr><tr class="even"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="odd"><td>total_minutes</td>
<td>numeric</td>
<td>Total minutes played</td>
</tr><tr class="even"><td>panna</td>
<td>numeric</td>
<td>PANNA rating (xRAPM)</td>
</tr><tr class="odd"><td>offense</td>
<td>numeric</td>
<td>Offensive rating</td>
</tr><tr class="even"><td>defense</td>
<td>numeric</td>
<td>Defensive rating</td>
</tr><tr class="odd"><td>off_deviation</td>
<td>numeric</td>
<td>Deviation from offensive prior</td>
</tr><tr class="even"><td>def_deviation</td>
<td>numeric</td>
<td>Deviation from defensive prior</td>
</tr><tr class="odd"><td>off_prior</td>
<td>numeric</td>
<td>SPM offensive prior</td>
</tr><tr class="even"><td>def_prior</td>
<td>numeric</td>
<td>SPM defensive prior</td>
</tr><tr class="odd"><td>base_panna</td>
<td>numeric</td>
<td>Base RAPM (no prior)</td>
</tr><tr class="even"><td>base_offense</td>
<td>numeric</td>
<td>Base offensive RAPM</td>
</tr><tr class="odd"><td>base_defense</td>
<td>numeric</td>
<td>Base defensive RAPM</td>
</tr><tr class="even"><td>spm_overall</td>
<td>numeric</td>
<td>Overall SPM prediction</td>
</tr><tr class="odd"><td>panna_percentile</td>
<td>numeric</td>
<td>Percentile rank (0-100)</td>
</tr><tr class="even"><td>panna_rank</td>
<td>numeric</td>
<td>Rank (1 = best)</td>
</tr></tbody></table><hr><hr></div>
</div>
<div class="section level2">
<h2 id="opta-data-schemas">Opta Data Schemas<a class="anchor" aria-label="anchor" href="#opta-data-schemas"></a></h2>
<p>Alternative data source from TheAnalyst/Opta API. Use <code>load_opta_*()</code> functions.</p>
<div class="section level3">
<h3 id="opta-player-stats-load_opta_stats">Opta Player Stats (<code>load_opta_stats()</code>)<a class="anchor" aria-label="anchor" href="#opta-player-stats-load_opta_stats"></a></h3>
<p>263 columns per player per match. Key columns:</p>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Opta match ID</td>
</tr><tr class="even"><td>match_date</td>
<td>Date</td>
<td>Match date</td>
</tr><tr class="odd"><td>player_id</td>
<td>character</td>
<td>Opta player ID</td>
</tr><tr class="even"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="odd"><td>team_id</td>
<td>character</td>
<td>Team ID</td>
</tr><tr class="even"><td>team_name</td>
<td>character</td>
<td>Team name</td>
</tr><tr class="odd"><td>team_position</td>
<td>character</td>
<td>“home” or “away”</td>
</tr><tr class="even"><td>minsPlayed</td>
<td>numeric</td>
<td>Minutes played</td>
</tr><tr class="odd"><td>position</td>
<td>character</td>
<td>Position (Goalkeeper, Defender, etc.)</td>
</tr><tr class="even"><td>goals</td>
<td>numeric</td>
<td>Goals scored</td>
</tr><tr class="odd"><td>totalScoringAtt</td>
<td>numeric</td>
<td>Total shots</td>
</tr><tr class="even"><td>ontargetScoringAtt</td>
<td>numeric</td>
<td>Shots on target</td>
</tr><tr class="odd"><td>bigChanceScored</td>
<td>numeric</td>
<td>Big chances scored</td>
</tr><tr class="even"><td>bigChanceMissed</td>
<td>numeric</td>
<td>Big chances missed</td>
</tr><tr class="odd"><td>goalAssist</td>
<td>numeric</td>
<td>Assists</td>
</tr><tr class="even"><td>accuratePass</td>
<td>numeric</td>
<td>Accurate passes</td>
</tr><tr class="odd"><td>totalPass</td>
<td>numeric</td>
<td>Total passes</td>
</tr><tr class="even"><td>successfulFinalThirdPasses</td>
<td>numeric</td>
<td>Final third passes completed</td>
</tr><tr class="odd"><td>wonTackle</td>
<td>numeric</td>
<td>Tackles won</td>
</tr><tr class="even"><td>totalTackle</td>
<td>numeric</td>
<td>Total tackles attempted</td>
</tr><tr class="odd"><td>interceptionWon</td>
<td>numeric</td>
<td>Interceptions won</td>
</tr><tr class="even"><td>aerialWon</td>
<td>numeric</td>
<td>Aerial duels won</td>
</tr><tr class="odd"><td>aerialLost</td>
<td>numeric</td>
<td>Aerial duels lost</td>
</tr><tr class="even"><td>duelWon</td>
<td>numeric</td>
<td>Total duels won</td>
</tr><tr class="odd"><td>duelLost</td>
<td>numeric</td>
<td>Total duels lost</td>
</tr><tr class="even"><td>touches</td>
<td>numeric</td>
<td>Ball touches</td>
</tr><tr class="odd"><td>touchesInOppBox</td>
<td>numeric</td>
<td>Touches in opponent’s box</td>
</tr><tr class="even"><td>possWonDef3rd</td>
<td>numeric</td>
<td>Possession won in defensive third</td>
</tr><tr class="odd"><td>possWonMid3rd</td>
<td>numeric</td>
<td>Possession won in middle third</td>
</tr><tr class="even"><td>possWonAtt3rd</td>
<td>numeric</td>
<td>Possession won in attacking third</td>
</tr><tr class="odd"><td>dispossessed</td>
<td>numeric</td>
<td>Times dispossessed</td>
</tr><tr class="even"><td>turnover</td>
<td>numeric</td>
<td>Turnovers</td>
</tr><tr class="odd"><td>fouls</td>
<td>numeric</td>
<td>Fouls committed</td>
</tr><tr class="even"><td>wasFouled</td>
<td>numeric</td>
<td>Fouls won</td>
</tr><tr class="odd"><td>saves</td>
<td>numeric</td>
<td>Goalkeeper saves</td>
</tr><tr class="even"><td>goalsConceded</td>
<td>numeric</td>
<td>Goals conceded (GK)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="opta-events-load_opta_events">Opta Events (<code>load_opta_events()</code>)<a class="anchor" aria-label="anchor" href="#opta-events-load_opta_events"></a></h3>
<p>Match events with timing for splint boundaries.</p>
<table class="table"><colgroup><col width="29%"><col width="22%"><col width="48%"></colgroup><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Opta match ID</td>
</tr><tr class="even"><td>event_type</td>
<td>character</td>
<td>goal, substitution, red_card, yellow_card, second_yellow</td>
</tr><tr class="odd"><td>minute</td>
<td>numeric</td>
<td>Event minute</td>
</tr><tr class="even"><td>second</td>
<td>numeric</td>
<td>Event second</td>
</tr><tr class="odd"><td>team_id</td>
<td>character</td>
<td>Team involved</td>
</tr><tr class="even"><td>player_id</td>
<td>character</td>
<td>Player involved</td>
</tr><tr class="odd"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="even"><td>player_on_id</td>
<td>character</td>
<td>Sub coming on (for substitutions)</td>
</tr><tr class="odd"><td>player_on_name</td>
<td>character</td>
<td>Name of sub coming on</td>
</tr><tr class="even"><td>player_off_id</td>
<td>character</td>
<td>Player leaving (for substitutions)</td>
</tr><tr class="odd"><td>player_off_name</td>
<td>character</td>
<td>Name of player leaving</td>
</tr><tr class="even"><td>assist_player_id</td>
<td>character</td>
<td>Assister (for goals)</td>
</tr><tr class="odd"><td>assist_player_name</td>
<td>character</td>
<td>Assister name</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="opta-shot-events-load_opta_shot_events">Opta Shot Events (<code>load_opta_shot_events()</code>)<a class="anchor" aria-label="anchor" href="#opta-shot-events-load_opta_shot_events"></a></h3>
<p>Individual shots with x/y coordinates.</p>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Opta match ID</td>
</tr><tr class="even"><td>event_id</td>
<td>integer</td>
<td>Unique shot event ID</td>
</tr><tr class="odd"><td>player_id</td>
<td>character</td>
<td>Shooter ID</td>
</tr><tr class="even"><td>player_name</td>
<td>character</td>
<td>Shooter name</td>
</tr><tr class="odd"><td>team_id</td>
<td>character</td>
<td>Team ID</td>
</tr><tr class="even"><td>minute</td>
<td>numeric</td>
<td>Shot minute</td>
</tr><tr class="odd"><td>second</td>
<td>numeric</td>
<td>Shot second</td>
</tr><tr class="even"><td>x</td>
<td>numeric</td>
<td>X coordinate (0-100, goal at 100)</td>
</tr><tr class="odd"><td>y</td>
<td>numeric</td>
<td>Y coordinate (0-100, center at 50)</td>
</tr><tr class="even"><td>outcome</td>
<td>integer</td>
<td>1=on target, 0=off target</td>
</tr><tr class="odd"><td>is_goal</td>
<td>logical</td>
<td>Shot resulted in goal</td>
</tr><tr class="even"><td>type_id</td>
<td>integer</td>
<td>13=saved, 14=post, 15=miss, 16=goal</td>
</tr><tr class="odd"><td>body_part</td>
<td>character</td>
<td>Head, LeftFoot, RightFoot</td>
</tr><tr class="even"><td>situation</td>
<td>character</td>
<td>OpenPlay, SetPiece, Corner, Penalty</td>
</tr><tr class="odd"><td>big_chance</td>
<td>logical</td>
<td>Big chance indicator</td>
</tr></tbody></table><p>Note: Opta API does not include xG values. Use <code>prepare_opta_shots_for_splints(use_goals_as_xg = TRUE)</code> for a basic proxy, or calculate xG from x/y coordinates with an external model.</p>
</div>
<div class="section level3">
<h3 id="opta-lineups-load_opta_lineups">Opta Lineups (<code>load_opta_lineups()</code>)<a class="anchor" aria-label="anchor" href="#opta-lineups-load_opta_lineups"></a></h3>
<p>Player lineup data with timing.</p>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>match_id</td>
<td>character</td>
<td>Opta match ID</td>
</tr><tr class="even"><td>match_date</td>
<td>Date</td>
<td>Match date</td>
</tr><tr class="odd"><td>player_id</td>
<td>character</td>
<td>Player ID</td>
</tr><tr class="even"><td>player_name</td>
<td>character</td>
<td>Player name</td>
</tr><tr class="odd"><td>team_id</td>
<td>character</td>
<td>Team ID</td>
</tr><tr class="even"><td>team_name</td>
<td>character</td>
<td>Team name</td>
</tr><tr class="odd"><td>team_position</td>
<td>character</td>
<td>“home” or “away”</td>
</tr><tr class="even"><td>position</td>
<td>character</td>
<td>Position (Goalkeeper, Defender, etc.)</td>
</tr><tr class="odd"><td>position_side</td>
<td>character</td>
<td>Left, Right, Centre</td>
</tr><tr class="even"><td>formation_place</td>
<td>integer</td>
<td>1-11 for starters</td>
</tr><tr class="odd"><td>shirt_number</td>
<td>integer</td>
<td>Jersey number</td>
</tr><tr class="even"><td>is_starter</td>
<td>logical</td>
<td>Started the match</td>
</tr><tr class="odd"><td>minutes_played</td>
<td>numeric</td>
<td>Total minutes played</td>
</tr><tr class="even"><td>sub_on_minute</td>
<td>numeric</td>
<td>Minute substituted on (0 if starter)</td>
</tr><tr class="odd"><td>sub_off_minute</td>
<td>numeric</td>
<td>Minute substituted off (0 if full match)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="using-opta-data-for-splints">Using Opta Data for Splints<a class="anchor" aria-label="anchor" href="#using-opta-data-for-splints"></a></h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load Opta data</span></span>
<span><span class="va">lineups</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_opta_lineups.html">load_opta_lineups</a></span><span class="op">(</span><span class="st">"ENG"</span>, <span class="st">"2024-2025"</span><span class="op">)</span></span>
<span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_opta_events.html">load_opta_events</a></span><span class="op">(</span><span class="st">"ENG"</span>, <span class="st">"2024-2025"</span><span class="op">)</span></span>
<span><span class="va">shots</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/load_opta_shot_events.html">load_opta_shot_events</a></span><span class="op">(</span><span class="st">"ENG"</span>, <span class="st">"2024-2025"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create processed data structure</span></span>
<span><span class="va">processed</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_opta_processed_data.html">create_opta_processed_data</a></span><span class="op">(</span></span>
<span>  opta_lineups <span class="op">=</span> <span class="va">lineups</span>,</span>
<span>  opta_events <span class="op">=</span> <span class="va">events</span>,</span>
<span>  opta_shot_events <span class="op">=</span> <span class="va">shots</span>,</span>
<span>  use_goals_as_xg <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Use goals as xG proxy</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create splints</span></span>
<span><span class="va">splints</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_all_splints.html">create_all_splints</a></span><span class="op">(</span><span class="va">processed</span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="rating-interpretation">Rating Interpretation<a class="anchor" aria-label="anchor" href="#rating-interpretation"></a></h2>
<div class="section level3">
<h3 id="offense-coefficient">Offense Coefficient<a class="anchor" aria-label="anchor" href="#offense-coefficient"></a></h3>
<ul><li>
<strong>Positive</strong> = Player helps team create MORE xG when attacking (GOOD)</li>
<li>Units: xG per 90 minutes above average</li>
</ul></div>
<div class="section level3">
<h3 id="defense-coefficient">Defense Coefficient<a class="anchor" aria-label="anchor" href="#defense-coefficient"></a></h3>
<ul><li>
<strong>Positive</strong> = Player allows MORE xG when defending (BAD)</li>
<li>
<strong>Negative</strong> = Player allows LESS xG when defending (GOOD)</li>
<li>Units: xG per 90 minutes relative to average</li>
</ul></div>
<div class="section level3">
<h3 id="final-rating">Final Rating<a class="anchor" aria-label="anchor" href="#final-rating"></a></h3>
<pre><code><span><span class="va">panna</span> <span class="op">=</span> <span class="va">offense</span> <span class="op">-</span> <span class="va">defense</span></span></code></pre>
<p>Higher = better overall impact</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a></h3>
<ul><li>Erling Haaland: offense = +0.15, defense = +0.02
<ul><li>Helps team create +0.15 xG/90 on offense</li>
<li>Allows +0.02 xG/90 on defense (slightly below average defender)</li>
<li>panna = 0.15 - 0.02 = +0.13</li>
</ul></li>
<li>Virgil van Dijk: offense = -0.02, defense = -0.10
<ul><li>Creates -0.02 xG/90 on offense (average)</li>
<li>Allows -0.10 xG/90 on defense (excellent defender)</li>
<li>panna = -0.02 - (-0.10) = +0.08</li>
</ul></li>
</ul></div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pete Owen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

